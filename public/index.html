<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
    <meta name="viewport" content="width=width, user-scalable=no">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.1/themes/smoothness/jquery-ui.css">  
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="http://underscorejs.org/underscore-min.js"></script>
    <script type="text/javascript" src="http://backbonejs.org/backbone-min.js"></script>
    <script type="text/javascript" src="external/mustache.js"></script>
    <script type='application/javascript' src='external/fastclick.js'></script>
     <script src="//code.jquery.com/ui/1.11.1/jquery-ui.js"></script>
    <!-- BACKBONE APPLICATION FILES TODO not correct path-->
    <script type="text/javascript" src="/application/router/router.js"></script>
    <script type="text/javascript" src="/application/views/base-view.js"></script>
    <script type="text/javascript" src="/application/views/departure-view.js"></script>
    <script type="text/javascript" src="/application/views/destination-view.js"></script>
    <script type="text/javascript" src="/application/views/change-city-view.js"></script>
    <script type="text/javascript" src="/application/views/result-view.js"></script>
    <script type="text/javascript" src="/application/views/info-view.js"></script>
    <script type="text/javascript" src="/application/models/city-model.js"></script>
    <script type="text/javascript" src="/application/models/city-collection.js"></script>
    <script type="text/javascript" src="/application/models/buss-stop-model.js"></script>
    <script type="text/javascript" src="/application/models/buss-stop-collection.js"></script>
    <script type="text/javascript" src="/application/models/travel-info-model.js"></script>
    <script type="text/javascript" src="/application/models/travel-info-collection.js"></script>
    <script type="text/javascript" src="/application/application.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/styles.css">

    <script type="text/javascript">
        $(document).ready(function() {

            var body = $("body"),
                mask = document.createElement("div"),
                toggleSlideLeft = document.querySelector( ".toggle-slide-left" ),
                slideMenuLeft = document.querySelector( ".slide-menu-left" ),
                activeNav = "";
        
            mask.className = "mask";    // dimming

            /* slide menu left */
            toggleSlideLeft.addEventListener( "click", function(){
                body.addClass("sml-open");
                document.body.appendChild(mask);
                activeNav = "sml-open";
            } );

            $(document).mouseup(function (e){
                var container = $("menulist");

                if (!container.is(e.target) // if the target of the click isn't the container...
                    && container.has(e.target).length === 0) // ... nor a descendant of the container
                {
                    if(activeNav.length > 0){
                        body.removeClass(activeNav);
                        activeNav = "";
                        document.body.removeChild(mask);
                    }
                }
            });
            
            window.addEventListener('load', function() {
                FastClick.attach(document.body);
            }, false);

            var setFooter = function setFooter() {
                var windowHeight = $(window).height();
                var headerHeight = $("#header").outerHeight();
                var footerHeight = $("#footer").outerHeight();
                var appHeight = windowHeight - (headerHeight + footerHeight);
                $("#app").css("min-height", appHeight);
            };
            setFooter();

            window.onresize = function() {
                setFooter();
            };

            function goToHomeHeader(){
                RuteVogn.router.navigate('', true);
            }

            (function(d, s, id) {   
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) return;
                js = d.createElement(s); js.id = id;
                js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
                fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));

            $(function(){
                var app = RuteVogn.Application;
                app.run();
            });
        });

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-45755254-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    </script>
    <title>rutebuss.no</title>
</head>
<body>
    <nav id="menulist" class="menu slide-menu-left">
        <ul class="menulist">
            <li><button class="custom-button close-menu">&larr; Close</button></li>
            <li><a href="#city">Velg by</a></li>
            <li><a href="#">Om siden</a></li>
        </ul>
    </nav>

    <div id="wrapper">
        <div id="fb-root"></div>
        <div id="header" class="app-header-container">

            <div class="app-header-general">
                <button id="showMenuButton" class="custom-button custom-button-header nav-toggler toggle-slide-left">Menu</button>
                <img class="logo-image" src="images/logo-buss.png" onClick="goToHomeHeader()">
                <h1>rutebuss.no</h1>
            </div>
        </div>

        <div id="app" class="app wrapper">
            <!--APP CONTENT WILL BE RENDERED HERE-->
        </div>

        <div id="footer" class="app-footer-container">
            <span class="footer-text-container">
                <a class="footer-mail" href="mailto:info@rutevogn.no">info@rutevogn.no</a>
                 -
                Data fra tromskortet.no/ruter.no
            </span>

            <div class="facebook-like-container fb-like"
                 data-href="https://www.facebook.com/rutebuss.no"
                 data-layout="button_count" data-action="like"
                 data-show-faces="true"
                 data-share="true">
            </div>
        </div>

    </div>

</body>
</html>